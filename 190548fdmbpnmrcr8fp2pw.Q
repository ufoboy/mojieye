[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=03092e36-7458-4896-8cf7-bdc21fe1fe33
Description=浏览器控件范例
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]

Event Form1.Button4.Click     //【论坛签到功能】   
    iehwnd = Form1.WebBrowser1.GetIEHwnd             '获取浏览器控件页面窗口句柄
    Dim text
    If Instr(Form1.WebBrowser1.Gethtml, "自动登录") = 0 Then 
        Form1.WebBrowser1.HtmlClickEx "id:pper_a"    '点击签到按钮
        Call 提示对话框("您的账号已自动签到，请更换其他账号登录")
    Else 
        Call 提示对话框("您的账号未登录，请在弹出的登录窗口中手动登录")
        '用元素特征串点击登陆按钮（提示：可使用“网页按键精灵”网页分析功能查找元素特征串）  
        Form1.WebBrowser1.HtmlClickEx "tag:EM&txt:登录"  
        Form1.Timer1.Enabled = False                 '防止被重复启动定时器   
        Form1.Timer1.Enabled = True  
    End If
End Event 


Event Form1.Timer1.Timer    //提取网页源文件判断账号是否登陆
    Dim text, 源码
    源码 = Form1.WebBrowser1.Gethtml
    If Instr(源码, "./source/plugin/dsu_amupper/images/dk.gif") > 0 Then       '打卡签到
        Form1.Timer1.Enabled = False
        Form1.WebBrowser1.HtmlClickEx "id:pper_a"                              '点击签到按钮
        Call 提示对话框("检测到您的账号已登陆，已自动签到成功")
    ElseIf Instr(源码, "./source/plugin/dsu_amupper/images/wb.gif") > 0 Then   '签到完毕（id:pper_b）
        Form1.Timer1.Enabled = False
        Call 提示对话框("检测到您的账号已签到！")
    End If
End Event



Event Form1.Load     //窗体1加载事件
    Form1.InputBox1.Text = "http://bbs.anjian.com/forum.php"
    Form1.WebBrowser1.Url = Form1.InputBox1.Text  
    Form1.Button2.Caption = "后退"
    Form1.Button3.Caption = "前进"
    Form1.Button1.Caption = "跳转页面"
    Form1.Button4.Caption = "【按键论坛一键签到】"
    Form1.Timer1.Enabled = False   '默认定时器是启动状态，所以要先停止   
    Form1.Timer1.Interval = 500    '设置定时器1循环的间隔时间（单位：毫秒）   
End Event  

Event Form1.Button2.Click   //页面后退
    Form1.WebBrowser1.Back   
End Event
Event Form1.Button3.Click   //页面前进
    Form1.WebBrowser1.Forward 
End Event
Event Form1.Button1.Click   //页面跳转
    Form1.WebBrowser1.Url = Form1.InputBox1.Text
End Event

Event Form1.WebBrowser1.DocumentComplete    //页面加载完成
    Form1.Label1.Caption = "  " & Form1.WebBrowser1.GetTitle
End Event
  
Event Form1.CheckBox1.Click    //查看网页源文件内容
    If Form1.CheckBox1.Value = 1 Then 
        Form1.InputBox2.Text = Form1.WebBrowser1.GetHtml
        Form1.WebBrowser1.Visible = False
        Form1.InputBox2.Visible = True
    Else 
        Form1.WebBrowser1.Visible = True
        Form1.InputBox2.Visible = False
    End If
End Event

Sub 提示对话框(内容)
    Form2.Label1.Caption = 内容
    Form2.ShowModal
End Sub

Event Form1.UnLoad 
    Form1.Timer1.Enabled = False  
    Form2.Close    '销毁窗体2
End Event
Event Form2.Button1.Click
    Form2.Close
End Event

